<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excalibur</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk&display=swap" rel="stylesheet">
<style>
    body {
        font-family: 'Space Grotesk', sans-serif;
        background-color: #000000;
        color: #FFFFFF;
        margin: 0;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        min-height: 100vh;
    }
    h1 {
        font-weight: 600;
        font-size: 36px;
        text-align: center;
        margin-top: 50px;
    }
    h1 span {
        display: inline-block;
        transition: transform 0.3s ease-in-out;
    }
    h1 span:hover {
        transform: rotate(-15deg);
    }
    .slogan {
        font-weight: 400;
        font-size: 18px;
        text-align: center;
        margin: 10px 0 30px;
    }
    #search-form {
        display: flex;
        justify-content: center;
        margin-bottom: 20px;
        width: 90%;
    }
    #search-input {
        padding: 10px;
        font-size: 16px;
        border: 1px solid #FFFFFF;
        border-radius: 0;
        width: 100%;
        margin-right: -1px;
        background-color: #000000;
        color: #FFFFFF;
    }
    #search-button {
        padding: 10px;
        font-size: 16px;
        border: 1px solid #FFFFFF;
        background-color: #000000;
        color: #FFFFFF;
        cursor: pointer;
        transition: background-color 0.3s;
    }
    #search-button:hover {
        background-color: #333333;
    }
    #results {
        margin-top: 20px;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 15px;
        width: 90%;
    }
    .result {
        cursor: pointer;
        width: 150px;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        transition: transform 0.3s ease-in-out;
    }
    .result:hover {
        transform: scale(1.05);
    }
    .poster {
        width: 100%;
        border-radius: 8px;
    }
    .movie-info {
        padding: 8px;
        background-color: #000000;
        font-size: 14px;
    }
    #video-player-container {
        display: none;
        flex-direction: column;
        align-items: center;
        margin-top: 20px;
        width: 90%;
    }
    #video-player {
        width: 100%;
        height: 720px;
        position: relative;
        border-radius: 10px;
        overflow: hidden;
    }
    #video-player iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: none;
    }
    .controls {
        display: flex;
        justify-content: center;
        margin-top: 10px;
        gap: 10px;
    }
    .controls label {
        font-weight: bold;
    }
    .controls select {
        padding: 5px;
        background-color: #000000;
        color: #FFFFFF;
        border: 1px solid #FFFFFF;
    }
    footer {
        text-align: center;
        font-size: 12px;
        color: #AAAAAA;
        margin-top: auto;
        padding: 20px 0;
        width: 100%;
    }
</style>
</head>
<body>
    <h1 id="title"><span>Excalibur</span></h1>
    <div class="slogan">minimalistic entertainment system</div>
    <form id="search-form">
        <input type="text" id="search-input" placeholder="Search for a movie or TV show...">
        <button type="submit" id="search-button">Search</button>
    </form>
    
    <div id="video-player-container">
        <div class="controls">
            <div class="source-selector">
                <label for="source">Source:</label>
                <select id="source">
                    <!-- Sources will be populated dynamically -->
                </select>
            </div>
            <div class="season-selector">
                <label for="season">Season:</label>
                <select id="season">
                    <!-- Seasons will be populated dynamically -->
                </select>
            </div>
            <div class="episode-selector">
                <label for="episode">Episode:</label>
                <select id="episode">
                    <!-- Episodes will be populated dynamically -->
                </select>
            </div>
        </div>
        <div id="video-player">
            <iframe id="video-player-iframe" allowfullscreen></iframe>
        </div>
    </div>

    <div id="results"></div>

    <footer>
        Ads may appear depending on the source, they are embedded into the video players and theyâ€™re out of my control. I would heavily recommend using an ad-blocker such as UBlock Origin or AdGuard for iOS.<br><br>
        Disclaimer: This website does not host any content. It provides links to third-party streaming services. Any legal issues related to the content should be addressed with the respective third-party services and not with this website.<br><br>
        Contact me at: excalibur.stream@proton.me
    </footer>

<script>
    const tmdbApiKey = 'a7601cfeacbd8bc8fd877c4f2d2bbe86';
    const searchForm = document.getElementById('search-form');
    const searchInput = document.getElementById('search-input');
    const resultsContainer = document.getElementById('results');
    const videoPlayerContainer = document.getElementById('video-player-container');
    const videoPlayerIframe = document.getElementById('video-player-iframe');
    const sourceSelect = document.getElementById('source');
    const seasonSelect = document.getElementById('season');
    const episodeSelect = document.getElementById('episode');

    const sources = [
        { name: 'vidlink.pro', movieUrl: tmdbId => `https://vidlink.pro/movie/${tmdbId}`, series: false },
        { name: 'vidsrc.nl', movieUrl: tmdbId => `https://player.vidsrc.nl/embed/movie/${tmdbId}`, seriesUrl: (tmdbId, season, episode) => `https://player.vidsrc.nl/embed/tv/${tmdbId}/${season}/${episode}`, series: true },
        { name: 'vidsrc.cc', movieUrl: tmdbId => `https://vidsrc.cc/v2/embed/movie/${tmdbId}`, seriesUrl: (tmdbId, season, episode) => `https://v2.vidsrc.me/embed/${tmdbId}/${season}-${episode}`, series: true },
        { name: 'vidsrc.to', movieUrl: tmdbId => `https://vidsrc.to/embed/movie/${tmdbId}`, seriesUrl: (tmdbId, season, episode) => `https://vidsrc.to/embed/tv/${tmdbId}/${season}-${episode}`, series: true },
        { name: 'vidsrc.icu', movieUrl: tmdbId => `https://vidsrc.icu/embed/movie/${tmdbId}`, seriesUrl: (tmdbId, season, episode) => `https://vidsrc.icu/embed/tv/${tmdbId}/${season}/${episode}`, series: true },
        { name: 'vidsrc.top', movieUrl: tmdbId => `https://vidsrc.top/embed/movie/tmdb/${tmdbId}`, seriesUrl: (tmdbId, season, episode) => `https://vidsrc.top/embed/tv/tmdb/${tmdbId}/${season}/${episode}`, series: true },
        { name: 'autoembed.cc', movieUrl: tmdbId => `https://player.autoembed.cc/embed/movie/${tmdbId}`, seriesUrl: (tmdbId, season, episode) => `https://player.autoembed.cc/embed/tv/${tmdbId}/${season}/${episode}`, series: true },   
        { name: 'multiembed.mov', movieUrl: tmdbId => `https://multiembed.mov/?video_id=${tmdbId}`, seriesUrl: (tmdbId, season, episode) => `https://multiembed.mov/?video_id=${tmdbId}&s=${season}&e=${episode}`, series: true },
        { name: 'multiembed.mov vip', movieUrl: tmdbId => `https://multiembed.mov/directstream.php?video_id=${tmdbId}`, seriesUrl: (tmdbId, season, episode) => `https://multiembed.mov/directstream.php?video_id=${tmdbId}&s=${season}&e=${episode}`, series: true },  
        { name: 'nontongo.win', movieUrl: tmdbId => `https://www.NontonGo.win/embed/movie/${tmdbId}`, seriesUrl: (tmdbId, season, episode) => `https://www.NontonGo.win/embed/tv/${tmdbId}/${season}/${episode}`, series: true },           
    ];      
    let selectedSource = sources[0];
    let currentMovie, currentSeason, currentEpisode;

    // Refresh page when the title is clicked
    const title = document.getElementById('title');
    title.addEventListener('click', () => {
        location.reload();
    });

    // Fetch search results from TMDB
    async function searchMovies(term) {
        try {
            const response = await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${tmdbApiKey}&query=${encodeURIComponent(term)}`);
            const data = await response.json();
            return data.results.filter(item => item.media_type === 'movie' || item.media_type === 'tv') || [];
        } catch (error) {
            console.error('Error fetching movie data:', error);
            return [];
        }
    }

    // Display search results
    function displayMovies(movies) {
        resultsContainer.innerHTML = '';
        movies.forEach(movie => {
            const resultDiv = document.createElement('div');
            resultDiv.classList.add('result');

            const poster = document.createElement('img');
            poster.classList.add('poster');
            poster.src = movie.poster_path ? `https://image.tmdb.org/t/p/w200${movie.poster_path}` : 'https://via.placeholder.com/200x300?text=No+Image';
            poster.alt = `${movie.title || movie.name} Poster`;

            const movieInfo = document.createElement('div');
            movieInfo.classList.add('movie-info');
            movieInfo.innerHTML = `<strong>${movie.title || movie.name}</strong><br>(${movie.release_date ? movie.release_date.substring(0, 4) : movie.first_air_date ? movie.first_air_date.substring(0, 4) : 'N/A'})`;

            resultDiv.appendChild(poster);
            resultDiv.appendChild(movieInfo);

            resultDiv.onclick = async () => {
                if (movie.media_type === 'tv') {
                    const totalSeasons = await fetchSeasonData(movie.id);
                    displaySourceSelector(movie, totalSeasons, 1);
                } else {
                    displaySourceSelector(movie, null, null);
                }
            };

            resultsContainer.appendChild(resultDiv);
        });
    }

    // Handle search form submission
    searchForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const searchTerm = searchInput.value.trim();
        if (searchTerm) {
            const movies = await searchMovies(searchTerm);
            displayMovies(movies);
        }
    });

    // Fetch season data for series
    async function fetchSeasonData(tmdbId) {
        const response = await fetch(`https://api.themoviedb.org/3/tv/${tmdbId}?api_key=${tmdbApiKey}`);
        const data = await response.json();
        return data.number_of_seasons || 1;
    }

    // Display video player and source selector
    function displaySourceSelector(movie, totalSeasons, season) {
        currentMovie = movie;
        currentSeason = season || null;
        currentEpisode = 1;

        sourceSelect.innerHTML = sources.map((src, idx) => `<option value="${idx}">${src.name}</option>`).join('');
        sourceSelect.onchange = () => selectSource(parseInt(sourceSelect.value));

        if (totalSeasons) {
            seasonSelect.innerHTML = Array.from({ length: totalSeasons }, (_, i) => `<option value="${i + 1}">Season ${i + 1}</option>`).join('');
            seasonSelect.onchange = () => {
                currentSeason = parseInt(seasonSelect.value);
                episodeSelect.innerHTML = '';
                loadEpisodes(currentSeason);
            };
            seasonSelect.style.display = 'inline-block';
            episodeSelect.style.display = 'inline-block';
            loadEpisodes(currentSeason);
        } else {
            seasonSelect.style.display = 'none';
            episodeSelect.style.display = 'none';
            playMovie(movie.id);
        }

        videoPlayerContainer.style.display = 'flex';
    }

    // Load episodes for the selected season
    async function loadEpisodes(season) {
        const response = await fetch(`https://api.themoviedb.org/3/tv/${currentMovie.id}/season/${season}?api_key=${tmdbApiKey}`);
        const data = await response.json();
        const episodes = data.episodes || [];
        episodeSelect.innerHTML = episodes.map((ep, idx) => `<option value="${ep.episode_number}">${ep.episode_number}: ${ep.name}</option>`).join('');
        episodeSelect.onchange = () => {
            currentEpisode = parseInt(episodeSelect.value);
            playSeries(currentMovie.id, currentSeason, currentEpisode);
        };
        playSeries(currentMovie.id, currentSeason, currentEpisode);
    }

    // Play movie from selected source
    function playMovie(tmdbId) {
        const movieUrl = selectedSource.movieUrl(tmdbId);
        videoPlayerIframe.src = movieUrl;
    }

    // Play series from selected source
    function playSeries(tmdbId, season, episode) {
        const seriesUrl = selectedSource.seriesUrl(tmdbId, season, episode);
        videoPlayerIframe.src = seriesUrl;
    }

    // Select source and play the content
    function selectSource(index) {
        selectedSource = sources[index];
        if (currentMovie.media_type === 'tv') {
            playSeries(currentMovie.id, currentSeason, currentEpisode);
        } else {
            playMovie(currentMovie.id);
        }
    }
</script>
</body>
</html>
